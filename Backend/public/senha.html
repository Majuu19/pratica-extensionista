<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recuperar Senha - HenSoma</title>

  <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+Antique:wght@400;900&display=swap" rel="stylesheet">

<style>
:root {
  --primary-gradient: linear-gradient(180deg, #59599B 0%, #24243E 59%, #0F0C29 100%);
  --shadow: 0px 4px 4px #AAA5E5;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Zen Kaku Gothic Antique', Arial, sans-serif;
  background: #F9F9FA;
  height: 100vh;
  display: flex;
  overflow: hidden;
}

.container {
  display: flex;
  width: 100%;
  height: 100%;
}


.sidebar {
  background: var(--primary-gradient);
  width: 100%;
  max-width: 470px;
  color: white;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 60px 32px 40px;
}

.logo {
  font-size: 3rem;
  font-weight: 900;
  margin-bottom: 32px;
}

.sidebar-img {
  width: 90%;
  max-width: 380px;
  border-radius: 16px;
  object-fit: cover;
  margin-bottom: 32px;
}

.sidebar-subtitle {
  font-size: 1.6rem;
  font-weight: 900;
  text-align: center;
  margin-bottom: 12px;
}

.sidebar-desc {
  text-align: center;
  font-size: 1.1rem;
  color: #D2D2E0;
  margin-top: 12px;
}


.main {
  flex: 1;
  padding: 40px 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  overflow-y: auto;
}

.main-title {
  font-size: 2.4rem;
  font-weight: 900;
  color: #24243E;
  text-align: center;
  margin-bottom: 12px;
}

.main-subtitle {
  font-size: 1rem;
  color: #424242;
  text-transform: uppercase;
  margin-bottom: 30px;
}


.form-box {
  background: white;
  width: 100%;
  max-width: 520px;
  padding: 32px;
  border-radius: 12px;
  box-shadow: 0 2px 16px #AAA5E522;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

label {
  font-size: 1.1rem;
  font-weight: 600;
  color: #24243E;
}

input {
  width: 100%;
  padding: 12px;
  border-radius: 6px;
  border: 1px solid #757575;
  font-size: 1rem;
  outline: none;
}

.btn-primary {
  background: #24243E;
  color: white;
  padding: 14px;
  font-size: 1.1rem;
  font-weight: 900;
  border-radius: 6px;
  cursor: pointer;
  border: none;
}

.btn-primary:hover {
  background: #59599B;
}

.btn-secondary {
  background: #D9D9D9;
  color: #24243E;
  padding: 14px;
  font-size: 1rem;
  font-weight: 900;
  border-radius: 6px;
  cursor: pointer;
  border: none;
}

.feedback {
  background: #D8F5D2;
  color: #1B6114;
  padding: 12px;
  font-weight: 700;
  text-align: center;
  border-radius: 6px;
  display: none;
}

</style>
</head>

<body>

<div class="container">

 
  <aside class="sidebar">
    <div class="logo">HenSoma</div>

    <img src="password.png" class="sidebar-img">

    <h2 class="sidebar-subtitle">Recuperar Senha</h2>

    <p class="sidebar-desc">
      Digite seu CPF ou CNPJ para receber instruções de redefinição.
    </p>
  </aside>

 
  <main class="main">

    <div class="main-title">Esqueci minha senha</div>
    <div class="main-subtitle">Informe seus dados para recuperar o acesso</div>

    <form class="form-box" onsubmit="enviarReset(event)">

      <div>
        <label>CPF ou CNPJ</label>
        <input id="doc" type="text" placeholder="Digite seu CPF ou CNPJ">
      </div>

      <button class="btn-primary" type="submit">Enviar instruções</button>

      <button class="btn-secondary" type="button" onclick="window.location.href='login.html'">
        Voltar ao Login
      </button>

      <div id="msg" class="feedback">✔ Enviamos um link de redefinição para seu e-mail!</div>

    </form>

  </main>

</div>

<script>
async function enviarReset(e) {
  e.preventDefault();

  const campo = document.getElementById("doc").value.trim();
  const msg = document.getElementById("msg");

  if (!campo) {
    msg.innerText = "Por favor, insira um CPF ou CNPJ válido.";
    msg.style.background = "#F5C4C4";
    msg.style.color = "#9E0B0B";
    msg.style.display = "block";
    return;
  }

  try {
    const res = await fetch("http://localhost:3001/api/auth/forgot-password", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ documento: campo })
    });

    const data = await res.json();

    if (!res.ok || data.status === 'error') {
      msg.innerText = data.message || "Erro ao solicitar recuperação";
      msg.style.background = "#F5C4C4";
      msg.style.color = "#9E0B0B";
      msg.style.display = "block";
      return;
    }

    msg.innerText = "✔ Se o usuário existir, enviamos instruções por e-mail!";
    msg.style.background = "#D8F5D2";
    msg.style.color = "#1B6114";
    msg.style.display = "block";

  } catch (err) {
    msg.innerText = "Erro ao conectar com o servidor.";
    msg.style.background = "#F5C4C4";
    msg.style.color = "#9E0B0B";
    msg.style.display = "block";
  }
}
</script>

</body>
</html>
